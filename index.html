<!doctype html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ã‚­ãƒ£ãƒªã‚¢å¿—å‘æ€§è¨ºæ–­</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    * {
      box-sizing: border-box;
    }
    
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans JP', 'Hiragino Sans', sans-serif;
      background: linear-gradient(135deg, #4f46e5 0%, #3b82f6 25%, #06b6d4 50%, #0891b2 75%, #0ea5e9 100%);
      background-size: 400% 400%;
      animation: gradientFlow 15s ease infinite;
      padding: 20px;
      overflow-y: auto;
      min-height: 100%;
    }

    @keyframes gradientFlow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .container {
      max-width: 850px;
      width: 100%;
      background: rgba(255, 255, 255, 0.98);
      backdrop-filter: blur(20px);
      border-radius: 32px;
      box-shadow: 0 30px 80px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.5);
      padding: 56px;
      margin: 40px auto;
    }

    .header {
      text-align: center;
      margin-bottom: 48px;
    }

    .header h1 {
      font-size: 38px;
      background: linear-gradient(135deg, #3b82f6 0%, #06b6d4 50%, #0891b2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin: 0 0 12px 0;
      font-weight: 900;
      letter-spacing: -0.8px;
    }

    .header p {
      font-size: 18px;
      color: #64748b;
      margin: 0;
      font-weight: 500;
    }

    .progress-container {
      margin-bottom: 36px;
    }

    .progress-text {
      font-size: 15px;
      color: #475569;
      margin-bottom: 12px;
      text-align: center;
      font-weight: 600;
    }

    .progress-bar {
      width: 100%;
      height: 12px;
      background: #e2e8f0;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #3b82f6 0%, #06b6d4 50%, #0891b2 100%);
      border-radius: 20px;
      transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 0 15px rgba(59, 130, 246, 0.5);
    }

    .intro-message {
      background: linear-gradient(135deg, #e0f2fe 0%, #dbeafe 100%);
      border-left: 5px solid #3b82f6;
      border-radius: 20px;
      padding: 28px;
      margin-bottom: 32px;
      font-size: 15px;
      line-height: 1.9;
      color: #1e40af;
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);
    }

    .question-container {
      background: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);
      border-radius: 28px;
      padding: 40px;
      margin-bottom: 32px;
      border: 3px solid rgba(251, 146, 60, 0.2);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.06);
    }

    .question-header {
      display: flex;
      align-items: flex-start;
      gap: 20px;
      margin-bottom: 28px;
    }

    .question-icon-container {
      flex-shrink: 0;
      width: 60px;
      height: 60px;
    }

    .question-text {
      font-size: 22px;
      color: #1e293b;
      font-weight: 700;
      line-height: 1.7;
      letter-spacing: -0.3px;
      white-space: pre-line;
      flex: 1;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-top: 32px;
    }

    .option-button {
      background: white;
      border: 3px solid #e2e8f0;
      border-radius: 18px;
      padding: 20px 28px;
      font-size: 17px;
      color: #334155;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      text-align: left;
      font-weight: 600;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.04);
      position: relative;
    }

    .option-button:hover {
      border-color: #3b82f6;
      background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
      transform: translateY(-4px);
      box-shadow: 0 12px 28px rgba(59, 130, 246, 0.2);
    }

    .option-button.selected {
      border-color: #3b82f6;
      background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
      font-weight: 700;
      box-shadow: 0 12px 32px rgba(59, 130, 246, 0.25);
      transform: translateY(-3px);
    }

    .option-button.selected::after {
      content: 'âœ“';
      position: absolute;
      right: 24px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 24px;
      color: #3b82f6;
      font-weight: 900;
    }

    .select-hint {
      font-size: 14px;
      color: #64748b;
      margin-top: 16px;
      text-align: center;
      font-weight: 600;
    }

    .nav-buttons {
      display: flex;
      gap: 20px;
      justify-content: space-between;
      margin-top: 40px;
    }

    .btn {
      padding: 18px 40px;
      border-radius: 18px;
      font-size: 18px;
      font-weight: 800;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: none;
      letter-spacing: 0.5px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #3b82f6 0%, #06b6d4 100%);
      color: white;
      flex: 1;
      box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
    }

    .btn-primary:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 32px rgba(59, 130, 246, 0.5);
    }

    .btn-primary:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .btn-secondary {
      background: white;
      color: #64748b;
      border: 3px solid #e2e8f0;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.04);
    }

    .btn-secondary:hover {
      border-color: #3b82f6;
      color: #3b82f6;
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(59, 130, 246, 0.15);
    }

    .result-container {
      text-align: center;
      padding: 20px 0;
    }

    .result-icon-container {
      width: 140px;
      height: 140px;
      margin: 0 auto 32px;
    }

    .result-title {
      font-size: 32px;
      background: linear-gradient(135deg, #3b82f6 0%, #06b6d4 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 20px;
      font-weight: 900;
    }

    .result-type {
      font-size: 28px;
      color: #1e293b;
      margin-bottom: 40px;
      font-weight: 800;
      line-height: 1.5;
    }

    .personality-section {
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      border-radius: 20px;
      padding: 32px;
      margin-bottom: 32px;
      border: 2px solid #e2e8f0;
      text-align: left;
    }

    .section-title {
      font-size: 20px;
      color: #1e293b;
      margin: 0 0 24px 0;
      font-weight: 800;
    }

    .personality-traits {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .trait-item {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 16px;
      color: #475569;
    }

    .trait-icon {
      font-size: 24px;
      flex-shrink: 0;
    }

    .trait-label {
      font-weight: 600;
      min-width: 180px;
    }

    .trait-value {
      font-weight: 700;
      color: #3b82f6;
    }

    .score-section {
      background: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);
      border-radius: 20px;
      padding: 32px;
      margin-bottom: 32px;
      border: 2px solid rgba(251, 146, 60, 0.2);
      text-align: left;
    }

    .score-bars {
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    .score-item {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .score-label {
      font-size: 16px;
      font-weight: 700;
      color: #1e293b;
      min-width: 80px;
    }

    .score-bar-container {
      flex: 1;
      height: 32px;
      background: white;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .score-bar {
      height: 100%;
      border-radius: 16px;
      transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 0 12px rgba(59, 130, 246, 0.4);
    }

    .score-value {
      font-size: 18px;
      font-weight: 800;
      color: #1e293b;
      min-width: 50px;
      text-align: right;
    }

    .description-section {
      background: linear-gradient(135deg, #e0f2fe 0%, #dbeafe 100%);
      border-radius: 20px;
      padding: 32px;
      margin-bottom: 32px;
      border-left: 5px solid #3b82f6;
      text-align: left;
    }

    .description-text {
      font-size: 16px;
      color: #1e40af;
      line-height: 1.9;
      font-weight: 600;
      white-space: pre-line;
    }

    .suggestion-section {
      background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
      border-radius: 20px;
      padding: 32px;
      margin-bottom: 32px;
      border-left: 5px solid #f59e0b;
      text-align: left;
    }

    .suggestion-title {
      font-size: 20px;
      color: #92400e;
      margin: 0 0 20px 0;
      font-weight: 800;
    }

    .suggestion-text {
      font-size: 15px;
      color: #78350f;
      line-height: 1.9;
      font-weight: 600;
      white-space: pre-line;
    }

    .external-factors-section {
      margin-bottom: 32px;
    }

    .external-factor-item {
      background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
      border-radius: 20px;
      padding: 32px;
      margin-bottom: 20px;
      border-left: 5px solid #ef4444;
      text-align: left;
    }

    .factor-title {
      font-size: 18px;
      color: #991b1b;
      margin: 0 0 16px 0;
      font-weight: 800;
    }

    .factor-text {
      font-size: 15px;
      color: #7f1d1d;
      line-height: 1.9;
      font-weight: 600;
      white-space: pre-line;
    }

    .closing-section {
      background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
      border-radius: 20px;
      padding: 32px;
      margin-bottom: 32px;
      border-left: 5px solid #22c55e;
      text-align: left;
    }

    .closing-title {
      font-size: 20px;
      color: #14532d;
      margin: 0 0 20px 0;
      font-weight: 800;
    }

    .closing-text {
      font-size: 15px;
      color: #166534;
      line-height: 1.9;
      font-weight: 600;
    }

    .start-screen {
      text-align: center;
    }

    .start-icon-container {
      width: 180px;
      height: 180px;
      margin: 0 auto 32px;
    }

    .start-description {
      font-size: 17px;
      color: #475569;
      line-height: 1.9;
      margin-bottom: 36px;
      text-align: left;
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      padding: 32px;
      border-radius: 20px;
      border: 2px solid #e2e8f0;
    }

    .start-description ul {
      margin: 20px 0;
      padding-left: 28px;
    }

    .start-description li {
      margin-bottom: 14px;
      font-weight: 600;
    }

    .start-description strong {
      color: #1e293b;
      font-size: 20px;
      display: block;
      margin-bottom: 16px;
    }

    @media (max-width: 768px) {
      .container {
        padding: 32px;
        margin: 20px auto;
      }

      .header h1 {
        font-size: 30px;
      }

      .header p {
        font-size: 16px;
      }

      .question-text {
        font-size: 19px;
      }

      .option-button {
        padding: 18px 22px;
        font-size: 16px;
      }

      .nav-buttons {
        flex-direction: column;
      }

      .btn {
        width: 100%;
      }

      .score-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }

      .score-bar-container {
        width: 100%;
      }

      .trait-label {
        min-width: auto;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1 id="main-title">ã‚­ãƒ£ãƒªã‚¢å¿—å‘æ€§è¨ºæ–­</h1>
      <p id="subtitle">ã‚ãªãŸã«åˆã†ã‚­ãƒ£ãƒªã‚¢ã‚’è¦‹ã¤ã‘ã‚ˆã†</p>
    </div>
    <div id="app-content"></div>
  </div>
  <script>
    const defaultConfig = {
      main_title: "ã‚­ãƒ£ãƒªã‚¢å¿—å‘æ€§è¨ºæ–­",
      subtitle: "ã‚ãªãŸã«åˆã†ã‚­ãƒ£ãƒªã‚¢ã‚’è¦‹ã¤ã‘ã‚ˆã†",
      result_title: "è¨ºæ–­çµæœ"
    };

    let currentStep = 'start';
    let currentQuestionIndex = 0;
    let answers = [];
    
    const preQuestions = [
      {
        icon: "person",
        text: "ã‚ãªãŸã®ç¾åœ¨ã®çŠ¶æ³ã«æœ€ã‚‚è¿‘ã„ã‚‚ã®ã‚’é¸ã‚“ã§ãã ã•ã„",
        type: "single",
        options: [
          "é«˜æ ¡ç”Ÿ(é€²è·¯é¸æŠä¸­)",
          "å¤§å­¦ç”Ÿãƒ»å°‚é–€å­¦æ ¡ç”Ÿ(1ã€œ2å¹´)",
          "å¤§å­¦ç”Ÿãƒ»å°‚é–€å­¦æ ¡ç”Ÿ(3å¹´ä»¥ä¸Šãƒ»å°±æ´»å‰å¾Œ)",
          "æ—¢å’ãƒ»å°±è·æµªäººä¸­",
          "ãã®ä»–"
        ]
      },
      {
        icon: "thought",
        text: "é€²è·¯ã‚„ã‚­ãƒ£ãƒªã‚¢ã‚’è€ƒãˆã‚‹æ™‚ã€ä»¥ä¸‹ã®ã‚ˆã†ãªæ°—æŒã¡ã‚„åˆ¶ç´„ã¯ã‚ã‚Šã¾ã™ã‹?\nå½“ã¦ã¯ã¾ã‚‹ã‚‚ã®ã‚’å…¨ã¦é¸ã‚“ã§ãã ã•ã„(è¤‡æ•°é¸æŠå¯)ã€‚ãªã‘ã‚Œã°ã€ç‰¹ã«ãªã„ã€ã§OK",
        type: "multiple",
        options: [
          "å®¶æ—ã®æœŸå¾…ãŒå¼·ãã€è‡ªç”±ã«é¸ã³ã«ãã„",
          "çµŒæ¸ˆçš„ãªäº‹æƒ…ã§ã€å¥¨å­¦é‡‘ã‚„å­¦è²»ã‚’æ°—ã«ã—ã¦ã„ã‚‹",
          "è‡ªåˆ†ã«è‡ªä¿¡ãŒãªãã€é¸æŠã«ä¸å®‰ã‚’æ„Ÿã˜ã‚‹",
          "å‘¨ã‚Šã®å‹é”ã¨é•ã†é¸æŠã‚’ã™ã‚‹ã“ã¨ã«æŠµæŠ—ãŒã‚ã‚‹",
          "éå»ã«ã€Œå‘ã„ã¦ãªã„ã€ã¨è¨€ã‚ã‚ŒãŸçµŒé¨“ãŒã‚ã‚Šã€é¿ã‘ãŸã„åˆ†é‡ãŒã‚ã‚‹",
          "åœ°å…ƒã‚’é›¢ã‚Œã‚‰ã‚Œãªã„äº‹æƒ…ãŒã‚ã‚‹",
          "ç‰¹ã«ãªã„ãƒ»è‡ªç”±ã«é¸ã¹ã‚‹"
        ]
      },
      {
        icon: "growth",
        text: "ä»¥ä¸‹ã®ã‚ˆã†ãªçµŒé¨“ã‚’ã—ãŸã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹?\nå½“ã¦ã¯ã¾ã‚‹ã‚‚ã®ãŒã‚ã‚Œã°é¸ã‚“ã§ãã ã•ã„",
        type: "multiple",
        options: [
          "æŠ€è¡“ç³»ã®æ´»å‹•ã§ã€å‘¨ã‚Šã«é¦´æŸ“ã‚ãªã‹ã£ãŸãƒ»å­¤ç«‹ã—ãŸçµŒé¨“",
          "ãƒªãƒ¼ãƒ€ãƒ¼å½¹ã‚’ä»»ã•ã‚Œã¦ã€ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ã‚’æ„Ÿã˜ãŸçµŒé¨“",
          "ã‚°ãƒ«ãƒ¼ãƒ—æ´»å‹•ã§ã€æ„è¦‹ãŒã¾ã¨ã¾ã‚‰ãšç–²ã‚ŒãŸçµŒé¨“",
          "ã€Œã‚ãªãŸã«ã¯å‘ã„ã¦ãªã„ã€ã¨è¨€ã‚ã‚Œã¦å‚·ã¤ã„ãŸçµŒé¨“",
          "å¤±æ•—ã—ã¦ã€å‘¨ã‚Šã‹ã‚‰å¦å®šçš„ãªåå¿œã‚’ã•ã‚ŒãŸçµŒé¨“",
          "ç‰¹ã«ãªã„"
        ]
      },
      {
        icon: "star",
        text: "å°†æ¥ã®ä»•äº‹ã‚„ã‚­ãƒ£ãƒªã‚¢ã‚’è€ƒãˆã‚‹æ™‚ã€ã‚ãªãŸãŒæœ€ã‚‚å¤§åˆ‡ã«ã—ãŸã„ã“ã¨ã‚’3ã¤é¸ã‚“ã§ãã ã•ã„",
        type: "multiple",
        maxSelect: 3,
        options: [
          "å¥½ããªã“ã¨ã‚’ä»•äº‹ã«ã—ãŸã„",
          "å®‰å®šã—ãŸåå…¥ãƒ»å°†æ¥ã®å®‰å¿ƒ",
          "å‘¨å›²ã‹ã‚‰èªã‚ã‚‰ã‚Œã‚‹ãƒ»è©•ä¾¡ã•ã‚Œã‚‹",
          "å®¶æ—ã‚„å¤§åˆ‡ãªäººã¨ã®æ™‚é–“",
          "è‡ªåˆ†ãŒæˆé•·ã—ç¶šã‘ã‚‰ã‚Œã‚‹",
          "ç¤¾ä¼šã«å½¹ç«‹ã¤ãƒ»èª°ã‹ã®å½¹ã«ç«‹ã¤",
          "åƒãæ™‚é–“ã‚„å ´æ‰€ãŒè‡ªç”±",
          "äººé–“é–¢ä¿‚ã®ã‚¹ãƒˆãƒ¬ã‚¹ãŒå°‘ãªã„",
          "å°‚é–€çš„ãªã‚¹ã‚­ãƒ«ã‚’èº«ã«ã¤ã‘ã‚‹",
          "äººã‚’ã¾ã¨ã‚ã‚‹ãƒ»å½±éŸ¿ã‚’ä¸ãˆã‚‹",
          "è¦ªã‚„å…ˆç”Ÿã®æœŸå¾…ã«å¿œãˆã‚‹",
          "ãƒªã‚¹ã‚¯ãŒå°‘ãªãã€å¤±æ•—ã—ãªã„"
        ]
      },
      {
        icon: "rainbow",
        text: "ã‚‚ã—ã€ãŠé‡‘ã‚„å‘¨ã‚Šã®ç›®ã€å¤±æ•—ã®ä¸å®‰ã‚’ä¸€åˆ‡æ°—ã«ã—ãªãã¦ã„ã„ã¨ã—ãŸã‚‰ã€ã‚ãªãŸã¯ã©ã‚“ãªæ–¹å‘ã«é€²ã¿ãŸã„ã§ã™ã‹?",
        type: "single",
        options: [
          "æŠ€è¡“ã‚’æ·±ãå­¦ã‚“ã§ã€å°‚é–€å®¶ã«ãªã‚ŠãŸã„",
          "ãƒ“ã‚¸ãƒã‚¹ã‚„çµ„ç¹”ã‚’å‹•ã‹ã™ç«‹å ´ã«ãªã‚ŠãŸã„",
          "äººã¨é–¢ã‚ã‚ŠãªãŒã‚‰ã€ä½•ã‹ã‚’ä½œã‚Šä¸Šã’ãŸã„",
          "ã¾ã åˆ†ã‹ã‚‰ãªã„ãƒ»ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ããªã„",
          "ãã®ä»–"
        ]
      }
    ];

    const mainQuestions = [
      {
        icon: "growth",
        text: "é›£ã—ã„ãƒ‘ã‚ºãƒ«ã‚„ã‚²ãƒ¼ãƒ ã®æ”»ç•¥æ³•ã‚’è€ƒãˆã‚‹æ™‚é–“ãŒã‚ã£ãŸã‚‰ã€ã¡ã‚‡ã£ã¨ã‚„ã£ã¦ã¿ãŸããªã‚‹",
        type: "scale",
        category: "positive"
      },
      {
        icon: "person",
        text: "ã‚°ãƒ«ãƒ¼ãƒ—æ´»å‹•ã§æ„è¦‹ã‚’ã¾ã¨ã‚ã‚‹å½¹ã‚’ä»»ã•ã‚ŒãŸã‚‰ã€ã‚„ã£ã¦ã¿ã¦ã‚‚ã„ã„ã‹ãªã¨æ€ã†",
        type: "scale",
        category: "positive"
      },
      {
        icon: "star",
        text: "ã€Œå®Œç’§ã«å‹•ãçŠ¶æ…‹ã€ã‚’ç›®æŒ‡ã—ã¦èª¿æ•´ã—ç¶šã‘ã‚‹ä½œæ¥­ã¯ã€ã‘ã£ã“ã†æ°—ã«ãªã‚‹",
        type: "scale",
        category: "positive"
      },
      {
        icon: "person",
        text: "å‹é”ã®æ„è¦‹ãŒå‰²ã‚Œã¦ã‚‹æ™‚ã€é–“ã«å…¥ã£ã¦è©±ã‚’èãå ´é¢ã‚’æƒ³åƒã™ã‚‹ã¨ã€ã¾ã‚æ‚ªããªã„ã‹ã‚‚",
        type: "scale",
        category: "positive"
      },
      {
        icon: "rainbow",
        text: "ã€Œèª°ã‚‚ã‚„ã£ãŸã“ã¨ãŒãªã„ã“ã¨ã€ã¨ã„ã†è¨€è‘‰ã‚’èãã¨ã€ã¡ã‚‡ã£ã¨ãƒ¯ã‚¯ãƒ¯ã‚¯ã™ã‚‹",
        type: "scale",
        category: "positive"
      },
      {
        icon: "person",
        text: "å¾Œè¼©ã‚„å‹é”ã«ä½•ã‹ã‚’æ•™ãˆã‚‹æ©Ÿä¼šãŒã‚ã£ãŸã‚‰ã€ã‚„ã£ã¦ã¿ãŸã„æ°—æŒã¡ã«ãªã‚‹",
        type: "scale",
        category: "positive"
      },
      {
        icon: "star",
        text: "è‡ªåˆ†ãŒä½œã£ãŸã‚‚ã®ãŒãšã£ã¨å®‰å®šã—ã¦å‹•ã„ã¦ã‚‹çŠ¶æ…‹ã‚’æƒ³åƒã™ã‚‹ã¨ã€å°‘ã—æº€è¶³æ„ŸãŒã‚ã‚‹",
        type: "scale",
        category: "positive"
      },
      {
        icon: "thought",
        text: "æ–‡åŒ–ç¥­ã§ã€Œæ¥å ´è€…æ•°ã€ãªã©ã®æ•°å­—ãŒè¦‹ãˆã‚‹ã¨ã€ãªã‚“ã¨ãªãæ°—ã«ãªã‚‹",
        type: "scale",
        category: "positive"
      },
      {
        icon: "growth",
        text: "æ–°ã—ã„æŠ€è¡“ãŒæ¬¡ã€…å‡ºã¦ãã¦ã‚‚ã€è¿½ã„ã‹ã‘ç¶šã‘ã‚‹ã“ã¨ã«ãã‚Œã»ã©æŠµæŠ—ã¯ãªã„",
        type: "scale",
        category: "negative"
      },
      {
        icon: "thought",
        text: "ç†å±ˆã§æ­£ã—ãã¦ã‚‚ã€ç©ºæ°—æ„Ÿã§æ±ºã¾ã‚‹å ´é¢ã§ã‚‚ã€ãã“ã¾ã§ã‚¤ãƒ©ã‚¤ãƒ©ã—ãªã„",
        type: "scale",
        category: "negative"
      },
      {
        icon: "star",
        text: "è‡ªåˆ†ã®ãƒŸã‚¹ãŒã™ããƒãƒ¬ã‚‹çŠ¶æ³ã§ã‚‚ã€ãã‚Œã»ã©è½ã¡è¾¼ã¾ãªã„",
        type: "scale",
        category: "negative"
      },
      {
        icon: "person",
        text: "ã„ã‚ã‚“ãªäººã®æœŸå¾…ã‚’åŒæ™‚ã«èƒŒè² ã£ã¦ã‚‚ã€æ½°ã‚Œãã†ã«ã¯ãªã‚‰ãªã„",
        type: "scale",
        category: "negative"
      },
      {
        icon: "thought",
        text: "è‡ªåˆ†ã®èˆˆå‘³ãŒå‘¨ã‚Šã¨é•ã„ã™ãã¦ç†è§£ã•ã‚Œãªãã¦ã‚‚ã€ãã‚“ãªã«æ°—ã«ãªã‚‰ãªã„",
        type: "scale",
        category: "negative"
      },
      {
        icon: "person",
        text: "è‡ªåˆ†ã®åˆ¤æ–­ãŒãƒãƒ¼ãƒ å…¨ä½“ã«å½±éŸ¿ã™ã‚‹ã¨ã—ã¦ã‚‚ã€é€ƒã’å‡ºã—ãŸãã¯ãªã‚‰ãªã„",
        type: "scale",
        category: "negative"
      },
      {
        icon: "star",
        text: "ç· ã‚åˆ‡ã‚Šå‰ã®å¾¹å¤œä½œæ¥­ãŒã‚ã£ã¦ã‚‚ã€æŠ•ã’å‡ºã—ãŸãã¯ãªã‚‰ãªã„",
        type: "scale",
        category: "negative"
      },
      {
        icon: "rainbow",
        text: "å ´æ‰€ã‚„æ™‚é–“ã«ç¸›ã‚‰ã‚Œãªã„åƒãæ–¹ã‚’æƒ³åƒã™ã‚‹ã¨ã€ã¡ã‚‡ã£ã¨ã„ã„ãªã¨æ€ã†",
        type: "scale",
        category: "positive"
      },
      {
        icon: "person",
        text: "ä¼šç¤¾ã®å¤§ããªæ–¹é‡ã«é–¢ã‚ã‚Œã‚‹ç«‹å ´ã‚’æƒ³åƒã™ã‚‹ã¨ã€é¢ç™½ãã†ã‹ã‚‚",
        type: "scale",
        category: "positive"
      },
      {
        icon: "star",
        text: "ã€Œè‡ªåˆ†ã®æŠ€è¡“åŠ›ã€ã§ä»•äº‹ã‚’é¸ã¹ã‚‹çŠ¶æ…‹ã‚’æƒ³åƒã™ã‚‹ã¨ã€ã¾ã‚è‰¯ã•ãã†",
        type: "scale",
        category: "positive"
      },
      {
        icon: "growth",
        text: "ã„ã‚ã‚“ãªæ¥­ç•Œã§ä½¿ãˆã‚‹ã‚¹ã‚­ãƒ«ãŒã‚ã£ãŸã‚‰ã€å®‰å¿ƒã§ããã†",
        type: "scale",
        category: "positive"
      },
      {
        icon: "star",
        text: "è‡ªåˆ†ãŒä½œã£ãŸã‚‚ã®ãŒãšã£ã¨ä½¿ã‚ã‚Œç¶šã‘ãŸã‚‰ã€ã¡ã‚‡ã£ã¨å¬‰ã—ã„",
        type: "scale",
        category: "positive"
      },
      {
        icon: "person",
        text: "ãƒãƒ¼ãƒ ã®é›°å›²æ°—ã‚’å¤‰ãˆã¦ã€ã¿ã‚“ãªãŒå¤‰ã‚ã‚‹æ§˜å­ã‚’æƒ³åƒã™ã‚‹ã¨ã€èˆˆå‘³ãŒã‚ã",
        type: "scale",
        category: "positive"
      },
      {
        icon: "thought",
        text: "ã€Œã“ã‚Œã£ã¦ã©ã†å‹•ã„ã¦ã‚‹ã®?ã€ã¨ã€è£å´ãŒæ°—ã«ãªã‚‹ã“ã¨ãŒã‚ã‚‹",
        type: "scale",
        category: "positive"
      },
      {
        icon: "rainbow",
        text: "æŠ€è¡“ã¯ã€Œã‚„ã‚ŠãŸã„ã“ã¨ã®æ‰‹æ®µã€ã ã¨è€ƒãˆã‚‹ã¨ã€ã—ã£ãã‚Šãã‚‹",
        type: "scale",
        category: "positive"
      },
      {
        icon: "person",
        text: "äººã®æ°—æŒã¡ã‚’å¯Ÿã—ã¦å‹•ãã“ã¨ã‚’æƒ³åƒã™ã‚‹ã¨ã€ã¾ã‚ã§ããã†",
        type: "scale",
        category: "positive"
      },
      {
        icon: "star",
        text: "ã€Œè«–ç†çš„ã«æ­£ã—ã„ã‹ã€ã‚’å¤§äº‹ã«ã—ãŸã„ã¨ã€ã¡ã‚‡ã£ã¨æ€ã†",
        type: "scale",
        category: "positive"
      },
      {
        icon: "thought",
        text: "è¦ªã‚„å…ˆç”ŸãŒå‹§ã‚ã‚‹é€²è·¯ã¨ã€è‡ªåˆ†ãŒã‚„ã‚ŠãŸã„ã“ã¨ãŒé•ã†å ´åˆã€ã©ã†æ„Ÿã˜ã¾ã™ã‹?",
        type: "scale",
        category: "external",
        options: [
          "å‘¨ã‚Šã®æœŸå¾…ã‚’å„ªå…ˆã™ã¹ã",
          "å°‘ã—æ‚©ã‚€ãŒå‘¨ã‚Šã«å¾“ã†",
          "ã©ã¡ã‚‰ã¨ã‚‚ã„ãˆãªã„",
          "æ‚©ã‚€ãŒè‡ªåˆ†ã®èˆˆå‘³å„ªå…ˆ",
          "è‡ªåˆ†ã®ã‚„ã‚ŠãŸã„ã“ã¨å„ªå…ˆ"
        ]
      },
      {
        icon: "growth",
        text: "æ–°ã—ã„ã“ã¨ã«æŒ‘æˆ¦ã™ã‚‹æ™‚ã€ã€Œå¤±æ•—ã—ãŸã‚‰ã©ã†ã—ã‚ˆã†ã€ã¨è€ƒãˆã¦ã€ã‚„ã‚ã¦ã—ã¾ã†ã“ã¨ãŒã‚ã‚Šã¾ã™ã‹?",
        type: "scale",
        category: "external",
        options: [
          "ã‚ˆãã‚ã‚‹",
          "ãŸã¾ã«ã‚ã‚‹",
          "ã©ã¡ã‚‰ã¨ã‚‚ã„ãˆãªã„",
          "ã‚ã¾ã‚Šãªã„",
          "ã»ã¨ã‚“ã©ãªã„"
        ]
      },
      {
        icon: "rainbow",
        text: "ã‚­ãƒ£ãƒªã‚¢ã‚’è€ƒãˆã‚‹æ™‚ã€ã€Œã‚„ã‚ŠãŸã„ã“ã¨ã€ã¨ã€Œã§ãã‚‹ã“ã¨ã€ã€ã©ã¡ã‚‰ã®æ°—æŒã¡ãŒå¼·ã„ã§ã™ã‹?",
        type: "scale",
        category: "external",
        options: [
          "ã€Œã§ãã‚‹ã“ã¨ã€ã‚’é¸ã³ãŸã„",
          "ã‚„ã‚„ã€Œã§ãã‚‹ã“ã¨ã€å„ªå…ˆ",
          "ã©ã¡ã‚‰ã¨ã‚‚ã„ãˆãªã„",
          "ã‚„ã‚„ã€Œã‚„ã‚ŠãŸã„ã“ã¨ã€å„ªå…ˆ",
          "ã€Œã‚„ã‚ŠãŸã„ã“ã¨ã€ã‚’é¸ã³ãŸã„"
        ]
      },
      {
        icon: "person",
        text: "å‹é”ã‚„å‘¨ã‚Šã®äººã¨ã€é•ã†é€²è·¯ã‚’é¸ã¶ã“ã¨ã‚’æƒ³åƒã™ã‚‹ã¨ã€ã©ã†æ„Ÿã˜ã¾ã™ã‹?",
        type: "scale",
        category: "external",
        options: [
          "ã‹ãªã‚Šä¸å®‰ãƒ»æŠµæŠ—ãŒã‚ã‚‹",
          "å°‘ã—ä¸å®‰",
          "ã©ã¡ã‚‰ã¨ã‚‚ã„ãˆãªã„",
          "ã‚ã¾ã‚Šæ°—ã«ãªã‚‰ãªã„",
          "å…¨ãæ°—ã«ãªã‚‰ãªã„"
        ]
      },
      {
        icon: "star",
        text: "å°†æ¥ã®ä»•äº‹ã‚’é¸ã¶æ™‚ã€ã€Œåå…¥ã®å®‰å®šã€ã¯ã€ã©ã®ãã‚‰ã„é‡è¦ã§ã™ã‹?",
        type: "scale",
        category: "external",
        options: [
          "æœ€å„ªå…ˆã§è€ƒãˆãŸã„",
          "ã‹ãªã‚Šé‡è¦",
          "æ™®é€š",
          "ã‚ã¾ã‚Šé‡è¦ã§ã¯ãªã„",
          "å…¨ãæ°—ã«ã—ãªã„"
        ]
      }
    ];

    const positiveOptions = [
      { value: 1, text: "ã»ã¨ã‚“ã©æ€ã‚ãªã„" },
      { value: 2, text: "ã‚ã¾ã‚Šæ€ã‚ãªã„" },
      { value: 3, text: "ã©ã¡ã‚‰ã¨ã‚‚ã„ãˆãªã„" },
      { value: 4, text: "å°‘ã—æ€ã†" },
      { value: 5, text: "ã‘ã£ã“ã†æ€ã†" }
    ];

    const negativeOptions = [
      { value: 1, text: "ã‹ãªã‚Šã‚­ãƒ„ã‚¤" },
      { value: 2, text: "ã¡ã‚‡ã£ã¨ã‚­ãƒ„ã‚¤" },
      { value: 3, text: "ã©ã¡ã‚‰ã¨ã‚‚ã„ãˆãªã„" },
      { value: 4, text: "ã¾ã‚å¤§ä¸ˆå¤«" },
      { value: 5, text: "å…¨ç„¶å¹³æ°—" }
    ];

    function getIconSVG(iconName) {
      const icons = {
        person: `<svg viewBox="0 0 200 200" width="100%" height="100%">
          <circle cx="100" cy="60" r="30" fill="#06b6d4"/>
          <path d="M70 100 Q100 90 130 100 L140 160 Q100 150 60 160 Z" fill="#0891b2"/>
          <circle cx="90" cy="55" r="3" fill="#fff"/>
          <circle cx="110" cy="55" r="3" fill="#fff"/>
          <path d="M90 70 Q100 75 110 70" stroke="#fff" stroke-width="2" fill="none"/>
        </svg>`,
        thought: `<svg viewBox="0 0 200 200" width="100%" height="100%">
          <circle cx="140" cy="60" r="15" fill="#06b6d4" opacity="0.6"/>
          <circle cx="120" cy="80" r="20" fill="#3b82f6" opacity="0.7"/>
          <ellipse cx="80" cy="110" rx="50" ry="45" fill="#0891b2"/>
          <text x="65" y="120" font-size="30" fill="#fff">?</text>
        </svg>`,
        growth: `<svg viewBox="0 0 200 200" width="100%" height="100%">
          <path d="M100 160 L100 80" stroke="#0891b2" stroke-width="8" stroke-linecap="round"/>
          <path d="M70 110 L100 80 L130 110" stroke="#3b82f6" stroke-width="8" stroke-linecap="round" fill="none"/>
          <circle cx="60" cy="140" r="12" fill="#06b6d4"/>
          <circle cx="100" cy="120" r="15" fill="#3b82f6"/>
          <circle cx="140" cy="100" r="18" fill="#0ea5e9"/>
        </svg>`,
        star: `<svg viewBox="0 0 200 200" width="100%" height="100%">
          <path d="M100 40 L110 80 L150 85 L120 110 L130 150 L100 130 L70 150 L80 110 L50 85 L90 80 Z" fill="#0ea5e9"/>
          <circle cx="100" cy="100" r="20" fill="#3b82f6"/>
          <circle cx="80" cy="70" r="8" fill="#06b6d4" opacity="0.7"/>
          <circle cx="130" cy="80" r="10" fill="#0891b2" opacity="0.6"/>
        </svg>`,
        rainbow: `<svg viewBox="0 0 200 200" width="100%" height="100%">
          <path d="M30 150 Q100 50 170 150" stroke="#3b82f6" stroke-width="12" fill="none" stroke-linecap="round"/>
          <path d="M40 150 Q100 70 160 150" stroke="#06b6d4" stroke-width="12" fill="none" stroke-linecap="round"/>
          <path d="M50 150 Q100 90 150 150" stroke="#0891b2" stroke-width="12" fill="none" stroke-linecap="round"/>
          <path d="M60 150 Q100 110 140 150" stroke="#0ea5e9" stroke-width="12" fill="none" stroke-linecap="round"/>
        </svg>`,
        start: `<svg viewBox="0 0 200 200" width="100%" height="100%">
          <circle cx="80" cy="100" r="70" fill="url(#grad1)" opacity="0.2"/>
          <circle cx="80" cy="100" r="50" fill="url(#grad1)" opacity="0.4"/>
          <circle cx="80" cy="100" r="30" fill="url(#grad1)"/>
          <path d="M80 75 L80 60 M80 125 L80 140 M55 100 L40 100 M105 100 L120 100" stroke="#fff" stroke-width="3" stroke-linecap="round"/>
          <circle cx="80" cy="100" r="12" fill="#fff"/>
          <path d="M76 100 L79 103 L87 93" stroke="#3b82f6" stroke-width="2.5" fill="none" stroke-linecap="round"/>
          <text x="130" y="115" font-size="48" font-weight="900" fill="url(#textGrad)" font-family="Arial, sans-serif">DX</text>
          <circle cx="160" cy="40" r="8" fill="#0ea5e9">
            <animate attributeName="opacity" values="1;0.3;1" dur="2s" repeatCount="indefinite"/>
          </circle>
          <circle cx="30" cy="50" r="6" fill="#06b6d4">
            <animate attributeName="opacity" values="0.3;1;0.3" dur="2.5s" repeatCount="indefinite"/>
          </circle>
          <circle cx="170" cy="160" r="7" fill="#0891b2">
            <animate attributeName="opacity" values="1;0.4;1" dur="3s" repeatCount="indefinite"/>
          </circle>
          <defs>
            <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#4f46e5"/>
              <stop offset="50%" style="stop-color:#3b82f6"/>
              <stop offset="100%" style="stop-color:#06b6d4"/>
            </linearGradient>
            <linearGradient id="textGrad" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#3b82f6"/>
              <stop offset="50%" style="stop-color:#06b6d4"/>
              <stop offset="100%" style="stop-color:#0891b2"/>
            </linearGradient>
          </defs>
        </svg>`,
        result: `<svg viewBox="0 0 200 200" width="100%" height="100%">
          <circle cx="100" cy="100" r="60" fill="url(#grad2)"/>
          <path d="M75 100 L90 115 L125 75" stroke="#fff" stroke-width="8" fill="none" stroke-linecap="round"/>
          <circle cx="160" cy="50" r="15" fill="#ffd364"/>
          <circle cx="40" cy="60" r="12" fill="#f093fb"/>
          <circle cx="170" cy="140" r="10" fill="#764ba2"/>
          <defs>
            <linearGradient id="grad2" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#f5576c"/>
              <stop offset="100%" style="stop-color:#f093fb"/>
            </linearGradient>
          </defs>
        </svg>`
      };
      return icons[iconName] || '';
    }

    function renderStartScreen() {
      const content = document.getElementById('app-content');
      content.innerHTML = `
        <div class="start-screen">
          <div class="start-icon-container">${getIconSVG('start')}</div>
          <div class="start-description">
            <strong>ã“ã®è¨ºæ–­ã«ã¤ã„ã¦</strong>
            <ul>
              <li>æ‰€è¦æ™‚é–“:ç´„10ã€œ15åˆ†</li>
              <li>è³ªå•æ•°:STEP1(5å•)+ STEP2(30å•)</li>
              <li>ã‚ãªãŸã«åˆã†ã‚­ãƒ£ãƒªã‚¢ã®æ–¹å‘æ€§ã‚’è¦‹ã¤ã‘ã¾ã™</li>
            </ul>
            <p style="margin-top: 24px; color: #64748b;">ãƒªãƒ©ãƒƒã‚¯ã‚¹ã—ã¦ã€ç›´æ„Ÿã§ç­”ãˆã¦ã¿ã¦ãã ã•ã„ã­ ğŸ˜Š</p>
          </div>
          <button class="btn btn-primary" onclick="startDiagnosis()">è¨ºæ–­ã‚’ã¯ã˜ã‚ã‚‹</button>
        </div>
      `;
    }

    function startDiagnosis() {
      currentStep = 'pre';
      currentQuestionIndex = 0;
      answers = [];
      renderQuestion();
    }

    function renderQuestion() {
      const content = document.getElementById('app-content');
      const isPreStep = currentStep === 'pre';
      const questions = isPreStep ? preQuestions : mainQuestions;
      const totalQuestions = preQuestions.length + mainQuestions.length;
      const currentAbsoluteIndex = isPreStep ? currentQuestionIndex : preQuestions.length + currentQuestionIndex;
      
      let progress = 0;
      if (isPreStep) {
        progress = (currentQuestionIndex / preQuestions.length) * 20;
      } else {
        if (currentQuestionIndex < 15) {
          progress = 20 + ((currentQuestionIndex / 15) * 40);
        } else {
          progress = 60 + (((currentQuestionIndex - 15) / 15) * 40);
        }
      }
      
      const question = questions[currentQuestionIndex];
      const stepLabel = isPreStep ? 'STEP1: äº‹å‰è³ªå•' : 'STEP2: æœ¬è¨ºæ–­';
      
      let introMessage = '';
      if (isPreStep && currentQuestionIndex === 0) {
        introMessage = `
          <div class="intro-message">
            è¨ºæ–­ã‚’å§‹ã‚ã‚‹å‰ã«ã€ã„ãã¤ã‹çŠ¶æ³ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚<br>
            ã‚ãªãŸã«åˆã£ãŸçµæœã‚’å‡ºã™ãŸã‚ã®è³ªå•ã§ã™ã€‚æ­£ç›´ã«ç­”ãˆã¦å¤§ä¸ˆå¤«ã§ã™ ğŸ˜Š
          </div>
        `;
      } else if (!isPreStep && currentQuestionIndex === 0) {
        introMessage = `
          <div class="intro-message">
            ã“ã“ã‹ã‚‰ã¯ã€ã‚ãªãŸã®èˆˆå‘³ã‚„é–¢å¿ƒã€æ€§æ ¼å‚¾å‘ã‚’çŸ¥ã‚‹ãŸã‚ã®è³ªå•ã§ã™ã€‚<br>
            æ­£è§£ã‚‚ä¸æ­£è§£ã‚‚ãªã„ã®ã§ã€æ°—æ¥½ã«ã€ä»Šã®è‡ªåˆ†ã€ã®æ„Ÿè¦šã§ç­”ãˆã¦ãã ã•ã„ã­ ğŸ˜Š
          </div>
        `;
      }
      
      content.innerHTML = `
        ${introMessage}
        <div class="progress-container">
          <div class="progress-text">${stepLabel} (${currentQuestionIndex + 1}/${questions.length})</div>
          <div class="progress-bar">
            <div class="progress-fill" style="width: ${progress}%"></div>
          </div>
        </div>
        
        <div class="question-container">
          <div class="question-header">
            <div class="question-icon-container">${getIconSVG(question.icon)}</div>
            <div class="question-text">${question.text}</div>
          </div>
          
          <div class="options" id="options-container"></div>
          ${question.type === 'multiple' ? '<div class="select-hint">â€»è¤‡æ•°é¸æŠå¯' + (question.maxSelect ? `(æœ€å¤§${question.maxSelect}ã¤ã¾ã§)` : '') + '</div>' : ''}
        </div>
        
        <div class="nav-buttons">
          ${currentAbsoluteIndex > 0 ? '<button class="btn btn-secondary" onclick="goBack()">ã‚‚ã©ã‚‹</button>' : '<div></div>'}
          <button class="btn btn-primary" id="next-btn" disabled onclick="goNext()">ã¤ãã¸</button>
        </div>
      `;
      
      renderOptions();
    }

    function renderOptions() {
      const isPreStep = currentStep === 'pre';
      const questions = isPreStep ? preQuestions : mainQuestions;
      const question = questions[currentQuestionIndex];
      const optionsContainer = document.getElementById('options-container');
      
      if (question.options) {
        optionsContainer.innerHTML = question.options.map((option, index) => `
          <button class="option-button" data-index="${index}" onclick="selectPreOption(${index})">
            ${option}
          </button>
        `).join('');
      } else {
        const options = question.category === 'negative' ? negativeOptions : positiveOptions;
        optionsContainer.innerHTML = options.map(option => `
          <button class="option-button" data-value="${option.value}" onclick="selectOption(${option.value})">
            ${option.text}
          </button>
        `).join('');
      }
    }

    function selectPreOption(index) {
      const isPreStep = currentStep === 'pre';
      const questions = isPreStep ? preQuestions : mainQuestions;
      const question = questions[currentQuestionIndex];
      const buttons = document.querySelectorAll('.option-button');
      
      const actualIndex = currentStep === 'pre' 
        ? currentQuestionIndex 
        : preQuestions.length + currentQuestionIndex;
      
      if (question.type === 'single') {
        buttons.forEach(btn => btn.classList.remove('selected'));
        buttons[index].classList.add('selected');
        
        if (!answers[actualIndex]) {
          answers[actualIndex] = [];
        }
        answers[actualIndex] = [index];
        
        document.getElementById('next-btn').disabled = false;
      } else if (question.type === 'multiple') {
        if (!answers[actualIndex]) {
          answers[actualIndex] = [];
        }
        
        const currentAnswers = answers[actualIndex];
        const indexPos = currentAnswers.indexOf(index);
        
        if (indexPos > -1) {
          currentAnswers.splice(indexPos, 1);
          buttons[index].classList.remove('selected');
        } else {
          if (question.maxSelect && currentAnswers.length >= question.maxSelect) {
            const firstSelected = currentAnswers.shift();
            buttons[firstSelected].classList.remove('selected');
          }
          currentAnswers.push(index);
          buttons[index].classList.add('selected');
        }
        
        document.getElementById('next-btn').disabled = currentAnswers.length === 0;
      }
    }

    function selectOption(value) {
      const buttons = document.querySelectorAll('.option-button');
      buttons.forEach(btn => {
        if (parseInt(btn.dataset.value) === value) {
          btn.classList.add('selected');
        } else {
          btn.classList.remove('selected');
        }
      });
      
      const nextBtn = document.getElementById('next-btn');
      nextBtn.disabled = false;
      
      const actualIndex = currentStep === 'pre' 
        ? currentQuestionIndex 
        : preQuestions.length + currentQuestionIndex;
      
      answers[actualIndex] = value;
    }

    function goBack() {
      if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
      } else if (currentStep === 'main') {
        currentStep = 'pre';
        currentQuestionIndex = preQuestions.length - 1;
      }
      renderQuestion();
      restoreAnswers();
    }

    function restoreAnswers() {
      const isPreStep = currentStep === 'pre';
      const questions = isPreStep ? preQuestions : mainQuestions;
      const question = questions[currentQuestionIndex];
      
      const actualIndex = currentStep === 'pre' 
        ? currentQuestionIndex 
        : preQuestions.length + currentQuestionIndex;
      
      if (answers[actualIndex]) {
        setTimeout(() => {
          if (question.options) {
            const selectedIndices = answers[actualIndex];
            selectedIndices.forEach(index => {
              const btn = document.querySelector(`[data-index="${index}"]`);
              if (btn) btn.classList.add('selected');
            });
          } else {
            const selectedBtn = document.querySelector(`[data-value="${answers[actualIndex]}"]`);
            if (selectedBtn) selectedBtn.classList.add('selected');
          }
          document.getElementById('next-btn').disabled = false;
        }, 0);
      }
    }

    async function goNext() {
      const isPreStep = currentStep === 'pre';
      const questions = isPreStep ? preQuestions : mainQuestions;
      
      if (currentQuestionIndex < questions.length - 1) {
        currentQuestionIndex++;
        renderQuestion();
        restoreAnswers();
      } else if (isPreStep && mainQuestions.length > 0) {
        currentStep = 'main';
        currentQuestionIndex = 0;
        renderQuestion();
      } else {
        await calculateAndShowResult();
      }
    }

    async function calculateAndShowResult() {
      const resultData = calculateResult();
      
      if (window.dataSdk) {
        const result = await window.dataSdk.create({
          id: Date.now().toString(),
          step: 'completed',
          answers: JSON.stringify(answers),
          result_type: resultData.heading,
          it_score: resultData.itScore,
          dx_score: resultData.dxScore,
          completed_at: new Date().toISOString()
        });
        
        if (!result.isOk) {
          console.error('ãƒ‡ãƒ¼ã‚¿ä¿å­˜ã‚¨ãƒ©ãƒ¼');
        }
      }
      
      renderResult(resultData);
    }

    function calculateResult() {
      let itScore = 0;
      const itPlus2Questions = [0, 2, 4, 8, 15, 17, 19, 21, 24];
      const itPlus1Questions = [6, 10, 12, 14];
      
      itPlus2Questions.forEach(qIndex => {
        const answerIndex = preQuestions.length + qIndex;
        if (answers[answerIndex]) {
          itScore += answers[answerIndex] * 2;
        }
      });
      
      itPlus1Questions.forEach(qIndex => {
        const answerIndex = preQuestions.length + qIndex;
        if (answers[answerIndex]) {
          itScore += answers[answerIndex] * 1;
        }
      });
      
      let dxScore = 0;
      const dxPlus2Questions = [1, 3, 5, 7, 9, 11, 13, 16, 20, 22, 23];
      const dxPlus1Questions = [18];
      
      dxPlus2Questions.forEach(qIndex => {
        const answerIndex = preQuestions.length + qIndex;
        if (answers[answerIndex]) {
          dxScore += answers[answerIndex] * 2;
        }
      });
      
      dxPlus1Questions.forEach(qIndex => {
        const answerIndex = preQuestions.length + qIndex;
        if (answers[answerIndex]) {
          dxScore += answers[answerIndex] * 1;
        }
      });
      
      const itScorePercent = Math.round((itScore / 80) * 100);
      const dxScorePercent = Math.round((dxScore / 85) * 100);
      
      let openness = 0;
      const opennessQuestions = [[0, 2], [4, 2], [8, 2], [21, 1]];
      opennessQuestions.forEach(([qIndex, weight]) => {
        const answerIndex = preQuestions.length + qIndex;
        if (answers[answerIndex]) {
          openness += answers[answerIndex] * weight;
        }
      });
      
      let conscientiousness = 0;
      const conscientiousnessQuestions = [[2, 2], [6, 2], [14, 1]];
      conscientiousnessQuestions.forEach(([qIndex, weight]) => {
        const answerIndex = preQuestions.length + qIndex;
        if (answers[answerIndex]) {
          conscientiousness += answers[answerIndex] * weight;
        }
      });
      
      let extraversion = 0;
      const extraversionQuestions = [[1, 2], [3, 1], [5, 1]];
      extraversionQuestions.forEach(([qIndex, weight]) => {
        const answerIndex = preQuestions.length + qIndex;
        if (answers[answerIndex]) {
          extraversion += answers[answerIndex] * weight;
        }
      });
      
      let agreeableness = 0;
      const agreeablenessQuestions = [[3, 1], [5, 1], [9, 1], [23, 2]];
      agreeablenessQuestions.forEach(([qIndex, weight]) => {
        const answerIndex = preQuestions.length + qIndex;
        if (answers[answerIndex]) {
          agreeableness += answers[answerIndex] * weight;
        }
      });
      
      let neuroticism = 0;
      const neuroticismReverseQuestions = [
        [10, 2],
        [11, 2],
        [12, 1],
        [13, 2]
      ];

      neuroticismReverseQuestions.forEach(([qIndex, weight]) => {
        const answerIndex = preQuestions.length + qIndex;
        if (answers[answerIndex]) {
          const reversedValue = 6 - answers[answerIndex];
          neuroticism += reversedValue * weight;
        }
      });

      const q27Index = preQuestions.length + 26;
      if (answers[q27Index]) {
        const reversedValue = 6 - answers[q27Index];
        neuroticism += reversedValue * 1;
      }
      
      function scoreToLevel(score, maxScore) {
        const percent = (score / maxScore) * 100;
        if (percent >= 80) return "é«˜ã„";
        if (percent >= 60) return "ã‚„ã‚„é«˜ã„";
        if (percent >= 40) return "æ™®é€š";
        if (percent >= 20) return "ã‚„ã‚„ä½ã„";
        return "ä½ã„";
      }
      
      function neuroticismToLevel(score) {
        const maxScore = 45;
        const percent = (score / maxScore) * 100;
        
        if (percent <= 20) return "é«˜ã„";
        if (percent <= 40) return "ã‚„ã‚„é«˜ã„";
        if (percent <= 60) return "æ™®é€š";
        if (percent <= 80) return "ã‚„ã‚„ä½ã„";
        return "ä½ã„";
      }
      
      const personality = [
        { icon: "ğŸ¨", label: "æ–°ã—ã„ã“ã¨ã¸ã®å¥½å¥‡å¿ƒ", value: scoreToLevel(openness, 28) },
        { icon: "ğŸ“‹", label: "è¨ˆç”»æ€§ãƒ»ã“ã ã‚ã‚Š", value: scoreToLevel(conscientiousness, 25) },
        { icon: "ğŸ—£ï¸", label: "ç¤¾äº¤æ€§", value: scoreToLevel(extraversion, 20) },
        { icon: "ğŸ¤", label: "å”èª¿æ€§", value: scoreToLevel(agreeableness, 25) },
        { icon: "ğŸ˜Š", label: "ã‚¹ãƒˆãƒ¬ã‚¹è€æ€§", value: neuroticismToLevel(neuroticism) }
      ];
      
      const scoreDiff = itScore - dxScore;
      
      let resultData = {};
      
      if (scoreDiff > 15) {
        resultData = {
          heading: "ğŸ”§ ã‚ãªãŸã¯ã€ŒæŠ€è¡“æ¢æ±‚å‹ã€ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“",
          description: `ã‚ãªãŸã¯ä»Šã®æ™‚ç‚¹ã§:
ãƒ»ä»•çµ„ã¿ã‚’ç†è§£ã™ã‚‹ã“ã¨ã«èˆˆå‘³ãŒã‚ã‚‹
ãƒ»ä½•ã‹ã‚’ä½œã‚Šä¸Šã’ã‚‹ã“ã¨ã«æŠµæŠ—ãŒãªã„
ãƒ»1äººã§é›†ä¸­ã™ã‚‹ä½œæ¥­ã‚‚è‹¦ã˜ã‚ƒãªã„
ãƒ»è«–ç†çš„ã«è€ƒãˆã‚‹ã“ã¨ã‚’å¤§äº‹ã«ã—ãŸã„

ã“ã‚“ãªå‚¾å‘ãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚

æŠ€è¡“ã‚’æ·±ãå­¦ã¶ITç³»ã®ã‚­ãƒ£ãƒªã‚¢ã ã¨ã€
ã€ã“ã‚Œãªã‚‰ç¶šã‘ã‚‰ã‚Œãã†ã€ã¨æ€ãˆã‚‹ç¬é–“ãŒå¤šã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚`,
          suggestion: `ãƒ»ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã«è§¦ã‚Œã¦ã¿ã‚‹(ç„¡æ–™ã®å­¦ç¿’ã‚µã‚¤ãƒˆã§éŠã‚“ã§ã¿ã‚‹ã ã‘ã§ã‚‚OK)
ãƒ»ã€ä»•çµ„ã¿ã€ã«èˆˆå‘³ãŒã‚ã‚‹ãªã‚‰ã€åˆ†è§£ãƒ»çµ„ã¿ç«‹ã¦ç³»ã®è¶£å‘³ã‚’è©¦ã—ã¦ã¿ã‚‹
ãƒ»æŠ€è¡“ç³»ã®ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚„ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã®ãã„ã¦ã¿ã‚‹(ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã§ã‚‚)

ã€ã‚„ã£ã¦ã¿ã¦é•ã£ãŸã‚‰ã€ãã‚Œã§OKã€
ãã‚‰ã„ã®æ°—æŒã¡ã§è©¦ã—ã¦ã¿ã‚‹ã¨ã€æ–°ã—ã„ç™ºè¦‹ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚`
        };
      } else if (scoreDiff < -15) {
        resultData = {
          heading: "ğŸ“Š ã‚ãªãŸã¯ã€Œäººã‚’å‹•ã‹ã™å‹ã€ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“",
          description: `ã‚ãªãŸã¯ä»Šã®æ™‚ç‚¹ã§:
ãƒ»äººã¨é–¢ã‚ã‚‹ã“ã¨ã«æŠµæŠ—ãŒãªã„
ãƒ»æ„è¦‹ã‚’ã¾ã¨ã‚ã‚‹å½¹å‰²ã‚‚æ‚ªããªã„
ãƒ»ãƒ“ã‚¸ãƒã‚¹ã®æˆæœã«èˆˆå‘³ãŒã‚ã‚‹
ãƒ»æŠ€è¡“ã¯ã€æ‰‹æ®µã€ã¨ã—ã¦ä½¿ã„ãŸã„

ã“ã‚“ãªå‚¾å‘ãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚

ãƒ“ã‚¸ãƒã‚¹ã‚„çµ„ç¹”ã‚’å‹•ã‹ã™DXç³»ã®ã‚­ãƒ£ãƒªã‚¢ã ã¨ã€
ã€è‡ªåˆ†ã‚‰ã—ãæ´»èºã§ããã†ã€ã¨æ€ãˆã‚‹å ´é¢ãŒå¤šã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚`,
          suggestion: `ãƒ»å­¦æ ¡è¡Œäº‹ã‚„éƒ¨æ´»ã§ã€ä¼ç”»ãƒ»é‹å–¶ã®å½¹å‰²ã«æ‰‹ã‚’æŒ™ã’ã¦ã¿ã‚‹
ãƒ»ãƒ“ã‚¸ãƒã‚¹ç³»ã®æœ¬ã‚’1å†Šèª­ã‚“ã§ã¿ã‚‹(é›£ã—ããªãã€é¢ç™½ãã†ãªã‚„ã¤ã§OK)
ãƒ»äººã¨è©±ã™ã®ãŒå¥½ããªã‚‰ã€ã„ã‚ã‚“ãªäººã®è©±ã‚’èã„ã¦ã¿ã‚‹

ã€é•ã£ãŸã‚‰ã€ãã‚Œã§OKã€
ãã‚‰ã„ã®æ°—æŒã¡ã§è©¦ã—ã¦ã¿ã‚‹ã¨ã€æ–°ã—ã„ç™ºè¦‹ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚`
        };
      } else if (itScore >= 40 && dxScore >= 40) {
        resultData = {
          heading: "âš–ï¸ ã‚ãªãŸã¯ã€Œãƒãƒ©ãƒ³ã‚¹å‹ã€ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“",
          description: `ã‚ãªãŸã¯ä»Šã®æ™‚ç‚¹ã§:
ãƒ»æŠ€è¡“ã«ã‚‚ã€äººã¨é–¢ã‚ã‚‹ã“ã¨ã«ã‚‚ã€ä¸¡æ–¹èˆˆå‘³ãŒã‚ã‚‹
ãƒ»ã©ã¡ã‚‰ã‹ä¸€æ–¹ã«åã‚‰ãšã€ãƒãƒ©ãƒ³ã‚¹ãŒå–ã‚Œã¦ã„ã‚‹

ã“ã‚“ãªå‚¾å‘ãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚

ITã¨DXã€ã©ã¡ã‚‰ã‹ä¸€æ–¹ã«æ±ºã‚ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
ä¸¡æ–¹ã®è¦ç´ ã‚’æŒã¤ã‚­ãƒ£ãƒªã‚¢ã‚‚ãŸãã•ã‚“ã‚ã‚Šã¾ã™ã€‚

ä¾‹ãˆã°:
ãƒ»æŠ€è¡“ã‚‚åˆ†ã‹ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼
ãƒ»ãƒ“ã‚¸ãƒã‚¹ã‚‚ç†è§£ã§ãã‚‹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢
ãƒ»æŠ€è¡“ã¨ãƒ“ã‚¸ãƒã‚¹ã‚’æ©‹æ¸¡ã—ã™ã‚‹å½¹å‰²

ã“ã†ã„ã†ã€ä¸¡æ–¹ã§ãã‚‹äººã€ã¯ã€å®Ÿã¯ã¨ã¦ã‚‚ä¾¡å€¤ãŒã‚ã‚Šã¾ã™ã€‚`,
          suggestion: `ãƒ»æŠ€è¡“ç³»ã®ã“ã¨ã‚’å°‘ã—è©¦ã—ã¦ã¿ã‚‹
ãƒ»äººã¨é–¢ã‚ã‚‹æ´»å‹•ã«ã‚‚å‚åŠ ã—ã¦ã¿ã‚‹
ãƒ»ä¸¡æ–¹ã‚„ã£ã¦ã¿ã¦ã€ã€ã©ã£ã¡ãŒæ¥½ã—ã„ã‹ãª?ã€ã¨è‡ªåˆ†ã«å•ã„ã‹ã‘ã¦ã¿ã‚‹

ã€ã©ã£ã¡ã‚‚ã‚„ã£ã¦ã¿ã‚‹ã€ã¨ã„ã†ã‚¹ã‚¿ã‚¤ãƒ«ã§ã€ã„ã‚ã‚“ãªçµŒé¨“ã‚’ç©ã‚“ã§ã„ãã¨ã€
è‡ªç„¶ã¨ã€ã“ã‚Œã !ã€ã¨æ€ãˆã‚‹ã‚‚ã®ã«å‡ºä¼šãˆã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚`
        };
      } else {
        resultData = {
          heading: "ğŸ” ã‚ãªãŸã¯ã€Œã“ã‚Œã‹ã‚‰æ¢ã™å‹ã€ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“",
          description: `ä»Šã®æ™‚ç‚¹ã§ã¯ã€ITã‚„DXã«å¯¾ã—ã¦
ã¾ã æ˜ç¢ºãªæ–¹å‘æ€§ãŒè¦‹ãˆã¦ã„ãªã„ã‚ˆã†ã§ã™ã€‚

ã§ã‚‚ã€ãã‚Œã¯å…¨ãå•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚

å¤šãã®äººã¯ã€å®Ÿéš›ã«ã„ã‚ã‚“ãªã“ã¨ã‚’çµŒé¨“ã™ã‚‹ä¸­ã§ã€
ã€ã“ã‚ŒãŒè‡ªåˆ†ã«åˆã£ã¦ã‚‹ã€ã¨æ°—ã¥ã„ã¦ã„ãã¾ã™ã€‚

ç„¦ã‚‰ãšã€ã„ã‚ã‚“ãªã“ã¨ã«è§¦ã‚Œã¦ã¿ã¦ãã ã•ã„ã€‚`,
          suggestion: `ãƒ»æŠ€è¡“ç³»ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚„ã€ãƒ“ã‚¸ãƒã‚¹ç³»ã®ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã«å‚åŠ ã—ã¦ã¿ã‚‹
ãƒ»å…ˆè¼©ã‚„ç¤¾ä¼šäººã®è©±ã‚’èã„ã¦ã¿ã‚‹
ãƒ»ã‚¢ãƒ«ãƒã‚¤ãƒˆã‚„ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã§ã€å®Ÿéš›ã®ä»•äº‹ã‚’ä½“é¨“ã—ã¦ã¿ã‚‹

ã€é•ã£ãŸã‚‰ã€æ¬¡ã‚’è©¦ã›ã°ã„ã„ã€
ãã‚“ãªæ°—æŒã¡ã§ã€æ¢ã—ã¦ã„ã£ã¦ãã ã•ã„ã­ã€‚`
        };
      }
      
      const externalFactors = [];
      
      const q26Answer = answers[preQuestions.length + 25];
      if ((answers[1] && answers[1].includes(0)) || (q26Answer && (q26Answer === 1 || q26Answer === 2))) {
        externalFactors.push({
          title: "âš ï¸ ã¡ã‚‡ã£ã¨æ°—ã«ãªã£ãŸã“ã¨",
          text: `è¨ºæ–­ã®ä¸­ã§ã€ã€å‘¨ã‚Šã®æœŸå¾…ãŒå¼·ã„ã€ã¨ã„ã†å›ç­”ãŒã‚ã‚Šã¾ã—ãŸã€‚

ã‚‚ã—ã€ã€æœ¬å½“ã¯é•ã†ã“ã¨ãŒã‚„ã‚ŠãŸã„ã€ã¨å¿ƒã®ã©ã“ã‹ã§æ€ã£ã¦ã„ã‚‹ãªã‚‰ã€
ä¸€åº¦ã€ä¿¡é ¼ã§ãã‚‹äººã«æ­£ç›´ã«è©±ã—ã¦ã¿ã¦ã‚‚ã„ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

ã€ã“ã£ã¡ã«èˆˆå‘³ãŒã‚ã‚‹ã‚“ã ã‘ã©ã€å‘¨ã‚Šã®æœŸå¾…ã¨é•ã†ã‹ã‚‰æ‚©ã‚“ã§ã‚‹ã€

ãã†ä¼ãˆã‚‹ã“ã¨ã§ã€æ€ã‚ã¬ç†è§£ã‚„è§£æ±ºç­–ãŒè¦‹ã¤ã‹ã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚`
        });
      }
      
      const q27Answer = answers[preQuestions.length + 26];
      if ((answers[1] && answers[1].includes(2)) || (q27Answer && (q27Answer === 1 || q27Answer === 2))) {
        externalFactors.push({
          title: "âš ï¸ ã¡ã‚‡ã£ã¨æ°—ã«ãªã£ãŸã“ã¨",
          text: `è¨ºæ–­ã®ä¸­ã§ã€ã€è‡ªåˆ†ã«è‡ªä¿¡ãŒãªã„ã€ã¨ã„ã†å›ç­”ãŒã‚ã‚Šã¾ã—ãŸã€‚

ã€è‡ªä¿¡ãŒãªã„ã€ã¨æ„Ÿã˜ã‚‹ã®ã¯ã€ã‚ãªãŸãŒæ…é‡ã§ã€çœŸé¢ç›®ã ã‹ã‚‰ã§ã™ã€‚
ãã‚Œã¯æ±ºã—ã¦æ‚ªã„ã“ã¨ã˜ã‚ƒã‚ã‚Šã¾ã›ã‚“ã€‚

è‡ªä¿¡ã¯ã€å°ã•ãªæˆåŠŸä½“é¨“ã‚’ç©ã¿é‡ã­ã‚‹ã“ã¨ã§ã€å°‘ã—ãšã¤è‚²ã£ã¦ã„ãã¾ã™ã€‚
ç„¦ã‚‰ãšã€ä¸€æ­©ãšã¤é€²ã‚“ã§ã„ã£ã¦ãã ã•ã„ã­ã€‚`
        });
      }
      
      const q30Answer = answers[preQuestions.length + 29];
      if ((answers[1] && answers[1].includes(1)) || (q30Answer && (q30Answer === 1 || q30Answer === 2))) {
        externalFactors.push({
          title: "âš ï¸ ã¡ã‚‡ã£ã¨æ°—ã«ãªã£ãŸã“ã¨",
          text: `è¨ºæ–­ã®ä¸­ã§ã€ã€åå…¥ã®å®‰å®šã€ã‚’é‡è¦–ã™ã‚‹å›ç­”ãŒã‚ã‚Šã¾ã—ãŸã€‚

ã‚‚ã—ã‹ã™ã‚‹ã¨ã€çµŒæ¸ˆçš„ãªä¸å®‰ã‹ã‚‰ã€
ã€ã‚„ã‚ŠãŸã„ã“ã¨ã€ã‚ˆã‚Šã€å®‰å®šã€ã‚’é¸ã¼ã†ã¨ã—ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã­ã€‚

å®‰å®šã‚‚å¤§äº‹ã§ã™ãŒã€ä¸¡ç«‹ã§ãã‚‹é“ã‚‚ã‚ã‚Šã¾ã™ã€‚
å¥¨å­¦é‡‘ã‚„æ”¯æ´åˆ¶åº¦ã€åƒããªãŒã‚‰å­¦ã¹ã‚‹é¸æŠè‚¢ãªã©ã€
é¸æŠè‚¢ã‚’åºƒã’ã¦ã¿ã‚‹ã®ã‚‚ä¸€ã¤ã®æ–¹æ³•ã§ã™ã€‚`
        });
      }
      
      const displayedFactors = externalFactors.slice(0, 2);
      
      return {
        heading: resultData.heading,
        personality: personality,
        itScore: itScorePercent,
        dxScore: dxScorePercent,
        description: resultData.description,
        suggestion: resultData.suggestion,
        externalFactors: displayedFactors
      };
    }

    function renderResult(resultData) {
      const content = document.getElementById('app-content');
      const resultTitleText = window.elementSdk?.config?.result_title || defaultConfig.result_title;
      
      content.innerHTML = `
        <div class="result-container">
          <div class="result-icon-container">${getIconSVG('result')}</div>
          <h2 class="result-title">${resultTitleText}</h2>
          
          <div class="result-type">${resultData.heading}</div>
          
          <div class="personality-section">
            <h3 class="section-title">ã‚ãªãŸã®æ€§æ ¼å‚¾å‘</h3>
            <div class="personality-traits">
              ${resultData.personality.map(trait => `
                <div class="trait-item">
                  <span class="trait-icon">${trait.icon}</span>
                  <span class="trait-label">${trait.label}:</span>
                  <span class="trait-value">${trait.value}</span>
                </div>
              `).join('')}
            </div>
          </div>
          
          <div class="score-section">
            <h3 class="section-title">å¿—å‘æ€§ã‚¹ã‚³ã‚¢</h3>
            <div class="score-bars">
              <div class="score-item">
                <div class="score-label">ITå¿—å‘</div>
                <div class="score-bar-container">
                  <div class="score-bar" style="width: ${resultData.itScore}%; background: linear-gradient(90deg, #3b82f6, #06b6d4);"></div>
                </div>
                <div class="score-value">${resultData.itScore}%</div>
              </div>
              <div class="score-item">
                <div class="score-label">DXå¿—å‘</div>
                <div class="score-bar-container">
                  <div class="score-bar" style="width: ${resultData.dxScore}%; background: linear-gradient(90deg, #0891b2, #0ea5e9);"></div>
                </div>
                <div class="score-value">${resultData.dxScore}%</div>
              </div>
            </div>
          </div>
          
          <div class="description-section">
            <div class="description-text">${resultData.description}</div>
          </div>
          
          <div class="suggestion-section">
            <h3 class="suggestion-title">ğŸŒŸ ã¡ã‚‡ã£ã¨è©¦ã—ã¦ã¿ã¦ã‚‚ã„ã„ã‹ã‚‚</h3>
            <div class="suggestion-text">${resultData.suggestion}</div>
          </div>
          
          ${resultData.externalFactors.length > 0 ? `
            <div class="external-factors-section">
              ${resultData.externalFactors.map(factor => `
                <div class="external-factor-item">
                  <h4 class="factor-title">${factor.title}</h4>
                  <div class="factor-text">${factor.text}</div>
                </div>
              `).join('')}
            </div>
          ` : ''}
          
          <div class="closing-section">
            <h3 class="closing-title">ğŸ“ å¿˜ã‚Œãªã„ã§ã»ã—ã„ã“ã¨</h3>
            <div class="closing-text">
              ã“ã®è¨ºæ–­ã¯ã€ä»Šã®ã‚ãªãŸã€ã®å‚¾å‘ã§ã™ã€‚<br>
              çµŒé¨“ã‚’é‡ã­ã‚‹ä¸­ã§ã€èˆˆå‘³ã‚„é–¢å¿ƒã¯å¤‰ã‚ã£ã¦ã„ãã¾ã™ã€‚<br><br>
              ã ã‹ã‚‰ã€ä»Šã®çµæœã«ç¸›ã‚‰ã‚Œã™ããšã€<br>
              ã„ã‚ã‚“ãªã“ã¨ã‚’è©¦ã—ãªãŒã‚‰ã€<br>
              è‡ªåˆ†ã«åˆã†ã‚‚ã®ã‚’è¦‹ã¤ã‘ã¦ã„ã£ã¦ãã ã•ã„ã­ã€‚<br><br>
              å¿œæ´ã—ã¦ã„ã¾ã™ğŸ˜Š
            </div>
          </div>
          
          <button class="btn btn-primary" onclick="restart()">ã‚‚ã†ä¸€åº¦è¨ºæ–­ã™ã‚‹</button>
        </div>
      `;
    }

    function restart() {
      currentStep = 'start';
      currentQuestionIndex = 0;
      answers = [];
      renderStartScreen();
    }

    const dataHandler = {
      onDataChanged(data) {
      }
    };

    async function initializeApp() {
      if (window.dataSdk) {
        const initResult = await window.dataSdk.init(dataHandler);
        if (!initResult.isOk) {
          console.error('Data SDKåˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼');
        }
      }

      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange: async (config) => {
            const mainTitleEl = document.getElementById('main-title');
            const subtitleEl = document.getElementById('subtitle');
            
            if (mainTitleEl) {
              mainTitleEl.textContent = config.main_title || defaultConfig.main_title;
            }
            if (subtitleEl) {
              subtitleEl.textContent = config.subtitle || defaultConfig.subtitle;
            }
          },
          mapToCapabilities: (config) => ({
            recolorables: [],
            borderables: [],
            fontEditable: undefined,
            fontSizeable: undefined
          }),
          mapToEditPanelValues: (config) => new Map([
            ["main_title", config.main_title || defaultConfig.main_title],
            ["subtitle", config.subtitle || defaultConfig.subtitle],
            ["result_title", config.result_title || defaultConfig.result_title]
          ])
        });
      }

      renderStartScreen();
    }

    initializeApp();
  </script>
</body>
</html>
